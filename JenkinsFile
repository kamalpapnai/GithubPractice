CODE_CHANGES = true
pipeline{

   agent any

   stages{

        stage("build"){
            when{
               expression{
                   env.BRANCH_NAME == 'master' && CODE_CHANGES == true
               }
           }

          steps{

              echo 'building the application'
          }

        }


        stage("test"){

           when{
               expression{
                   env.BRANCH_NAME == 'dev' || env.BRANCH_NAME == 'master'
               }
           }

           steps{
               echo 'testing the application'
           }

        }


        stage("deploy"){


            steps{
                echo 'deploying the application'
            }
        }

   }

   post{

       always{
           echo 'This will be executed always even if build fails or succedded'
       }

       success{
          echo 'Only when build is success'
       }

       failure{
          echo 'Only when build is failed'
       }


   }

}
